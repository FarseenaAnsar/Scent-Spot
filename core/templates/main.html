{% extends 'base.html' %}
{% load static %}

{% block css %}
<link href="static/css/main.css" rel="stylesheet" type="text/css">
{% endblock %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    {% comment %} <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"> {% endcomment %}
{% block content %}
{% load cart %}
    
    {% if messages %}
    <div class="messages-container">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div id="fragrance_carousel" class="carousel slide" data-bs-ride="carousel">
        <!-- Add indicators -->
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#fragrance_carousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#fragrance_carousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#fragrance_carousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
        </div>

        <div class="carousel-inner fragrance">
            <div class="carousel-item active">
                <img src="{% static 'images/valentine.jpg' %}" class="d-block w-100 c_img" alt="1st img">
            </div>
            <div class="carousel-item">
                <img src="{% static 'images/Valentines.webp' %}" class="d-block w-100 c_img" alt="2nd img">
            </div>
            <div class="carousel-item">
                <img src="{% static 'images/carousel5.jpg' %}" class="d-block w-100 c_img" alt="3rd img">
            </div>
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#fragrance_carousel" data-bs-slide="prev">
            {% comment %} <span class="carousel-control-prev-icon" aria-hidden="true"></span> {% endcomment %}
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#fragrance_carousel" data-bs-slide="next">
            {% comment %} <span class="carousel-control-next-icon" aria-hidden="true"></span> {% endcomment %}
        </button>
    </div>

    <br>
    <p class="p"><a class="p_link" href="/index">See All Products</a></p>
    <br>
    <div id="carouselExampleControls" class="carousel slide" data-interval="false">
        <div class="carousel-inner prd_carousel">
            {% for p in prds %}
                <div class="carousel-item item active">
                    <div class="card">
                        <div class="image-container">
                            <img class="card-img-top" src="{{p.image.url}}" alt="Card Image">
                            <p class="product_label"><i class="fas fa-compress-alt fa-lg"></i></p>
                            <a class="product_btn" href="/products?product_id={{p.id}}">o</a>
                            <!-- wishlist button -->
                            <form method="POST" action="{% url 'add_to_wishlist' p.id %}" class="wishlist-form">
                                {% csrf_token %}
                                <button type="submit" class="wishlist-btn {% if p in user_wishlist %}in-wishlist{% endif %}">
                                    <i class="fas fa-heart"></i>
                                </button>
                            </form>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">{{p.name}}</h5>
                            <p class="card-text">{{p.price|currency}}</p>
                            {% if p.rating != 0 %}
                                {% for i in p.rating|loop_counter %}
                                    <i class="fas fa-star"></i>
                                {% endfor %}
                            {% else %}
                                {% for i in 5|loop_counter %}
                                    <i class="fas fa-star"></i>
                                    
                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

        <button class="carousel-control-prev" onclick="my_prev()" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        </button>
        <button class="carousel-control-next" onclick="my_next()" type="button" data-bs-target="#carouselExampleControls" data-bs-slide=""00 >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
        </button>
    </div>
    <br>
    <div class="banner">
        <div class="banner-content">
            <div class="banner-text">
                <h1>Fragrance that last forever</h1>
                <button class="banner-btn">Buy Now</button>
            </div>
            <div class="banner-image">
                <img src="{% static 'images/banner1.jpg' %}" alt="Luxury Perfume">
            </div>
        </div>
    </div>   
    {% comment %} <div class="container-fluid brand">
        <p class="b">Brands Available</p>
        <div class="row justify-content-md-center">
            {% for b in brands %}
                <div class="col-3 brand_cir">
                    <div class="b_edit">
                        <img
                            src="{{b.image.url}}"
                            class="img_edit">
                        <p class="content">{{b.brand_name}}</p>
                        <form action="/index" method="POST">
                            {% csrf_token %}
                            <input hidden value="{{b.brand_name}}" name="brands">
                            <input type="submit" class="brand_cir_btn" style="opacity:0;">
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div> {% endcomment %}
    <div class="container">
        <h1 class="banner-h1">New Arrival</h1>
        <div class="grid">
            <div class="card large">
                <img src="{% static 'images/bleubanner.jpg' %}" height="600" width="400" alt="Chanel Bleu Perfume">
                <div class="card-content">
                    <h2 class="card-title">Chanel - Bleu</h2>
                    <p class="card-description">Chanel - Bleu coming out on sale.</p>
                    <a href="#" class="shop-now">Shop Now</a>
                </div>
            </div>
            <div class="card">
                <img src="{% static 'images/womenbanner.jpg' %}" height="300" width="400" alt="Women's Collections">
                <div class="card-content">
                    <h2 class="card-title">Women's Collections</h2>
                    <p class="card-description">Featured woman collections that give you another vibe.</p>
                    <a href="#" class="shop-now">Shop Now</a>
                </div>
            </div>
            <div class="card">
                <img src="{% static 'images/jimmychoobanner.webp' %}" height="300" width="400" alt="Armani White Perfume">
                <div class="card-content">
                    <h2 class="card-title">Jimmy Choo</h2>
                    <p class="card-description">Jimmy Choo Perfumes</p>
                    <a href="#" class="shop-now">Shop Now</a>
                </div>
            </div>
        </div>
    </div>
    <div>
        <section class="features-section">
            <div class="features-container">
              <div class="feature">
                <div class="feature-icon">
                  <img src="{% static 'images/delivery_icon.png' %}"height="32" width="32" alt="Delivery truck icon" />
                </div>
                <h3 class="feature-title">FREE AND FAST DELIVERY</h3>
                <p class="feature-description">Free delivery for all orders over $140</p>
              </div>
          
              <div class="feature">
                <div class="feature-icon">
                  <img src="{% static 'images/customer_service.png' %}"height="32" width="32" alt="Customer service icon" />
                </div>
                <h3 class="feature-title">24/7 CUSTOMER SERVICE</h3>
                <p class="feature-description">Friendly 24/7 customer support</p>
              </div>
          
              <div class="feature">
                <div class="feature-icon">
                  <img src="{%  static 'images/shield_icon.png' %}"height="32" width="32" alt="Shield icon" />
                </div>
                <h3 class="feature-title">MONEY BACK GUARANTEE</h3>
                <p class="feature-description">We return money within 30 days</p>
              </div>
            </div>
          </section>
    </div>

{% endblock %}
{% block js %}
    <script>
        var pos = 0;
        var carousel_width = document.getElementsByClassName("prd_carousel")[0].scrollWidth;
        var carouselitem_width = JSON.parse(carousel_width) / 9
        //to calculate the width of one carousel item. thie is not used because the result was in px units
        /*var ele = document.getElementsByClassName("item")[0];
            properties = window.getComputedStyle(ele, null);
            var carouselitem_width = properties.width;
            var pos = 0;*/  

        function my_next() {   
            if (pos < parseInt(carousel_width - carouselitem_width*4)) {
                pos += carouselitem_width;
                var move = document.getElementsByClassName("prd_carousel")[0]
                move.scrollTo({top: 0,
                                left: pos,
                                behavior: 'smooth'});
            }
        }

        function my_prev() {
            if (pos > 0) {
                pos -= carouselitem_width
                console.log(pos)
                var move = document.getElementsByClassName("prd_carousel")[0]
                move.scrollTo( {top: 0,
                                left: pos,
                                behavior: 'smooth'});
            }
        }
        document.addEventListener('DOMContentLoaded', function() {
            // Create overlay div
            const overlay = document.createElement('div');
            overlay.className = 'overlay';
            document.body.appendChild(overlay);
        
            // Get all product images
            const productImages = document.querySelectorAll('.card-img-top');
        
            productImages.forEach(img => {
                img.addEventListener('click', function() {
                    if (!this.classList.contains('zoomed')) {
                        // Zoom in
                        this.classList.add('zoomed');
                        overlay.style.display = 'block';
                    } else {
                        // Zoom out
                        this.classList.remove('zoomed');
                        overlay.style.display = 'none';
                    }
                });
            });
        
            // Close zoom when clicking overlay
            overlay.addEventListener('click', function() {
                const zoomedImage = document.querySelector('.zoomed');
                if (zoomedImage) {
                    zoomedImage.classList.remove('zoomed');
                    overlay.style.display = 'none';
                }
            });
        });
        
    </script>
{% endblock %}

{% block scripts %}
{% endblock scripts %}
<script src="{% static '/js/checkout.js' %}"> </script>